
#include <iostream>
#include "math.h"

using namespace std;

class Functions
{
    public:
    
    
    double FixedRateFixedInstUnknownPV(double r, double PMT, int n)
    {
        double PV = 0;
        
        if (n < 1)
        {
            cout<<"The number of periods must be >= 1 !!";
            return -1;
        }
        if (PMT <= 0)
        {
            cout<<"The instalment must be > 0 !!";
            return -1;
        }
        if (r <= -1)
        {
            cout<<"The interest rate must be > -1 !!";
            return -1;
        }
        
        
        if (n==1)
        {
            PV = PMT / (1 + r);
            return PV;
        }
        else
        {
            double nom = 0;
            double denom = 0;
            double r1 = r + 1;
            double rexponent = 1;
            
            for (int i = 1; i < n; i++)
            {
                nom += (n - i) * rexponent;
                denom += rexponent;
                rexponent *= r1;
            }
            denom += rexponent;
            
            nom = n + (r * nom);
            denom = 1 + (r * denom);
            
            if (denom > 0)
            {
                PV = (nom / denom) * PMT;
                return PV;
            }
            else
            {
                cout<<"Bad Calculation !!";
                return -1;
            }
            
        }
    }
};


int main()
{
    Functions calculator;

        cout<<"Please enter a rate: ";
        double r;// = 0.05;
        cin >> r;
        cout<<"Please enter an instalement value: ";
        double PMT;// = 2309.75;
        cin >> PMT;
        cout<<"Please enter a number of periods: ";
        int n;// = 5;
        cin >> n;
        
        double PV = calculator.FixedRateFixedInstUnknownPV(r, PMT, n);
        
        if (PV != -1)
        {
            cout<<"The initial nominal of the loan is:\n";
            cout<<to_string(PV);
        }
        else
        {
            cout<<"Please retry";
        }
    }
    
    
    

